%!PS-Adobe-2.0
%%Creator: Sergei S. Betke
%%EndComments

(lib.ps) findlibfile { exch pop cvx exec } { (Error: file lib.ps not found!) =  pop stop } ifelse

(boxes.ps) require_once

/stringheight
{
  string_BBox
  size_of_BBox
  exch pop
} bind def

/string_center_bottom
{
  dup string_BBox
    exch  4 -1 roll  sub  2 div  neg
    3 1 roll  pop  neg
  rmoveto
} bind def

/string_center_middle
{
  dup string_BBox
    exch  4 -1 roll  sub  2 div  neg
    3 1 roll  add  2 div  neg
  rmoveto
} bind def

/string_left_middle
{
  dup string_BBox
    exch  4 -1 roll  exch pop  neg
    3 1 roll  add  2 div  neg
  rmoveto
} bind def

/string_right_middle
{
  dup string_BBox
    exch  4 -1 roll  pop  neg
    3 1 roll  add  2 div  neg
  rmoveto
} bind def

/arc_angle_from
{
  5 dict begin
  /y1 exch def
  /x1 exch def
  /r exch def
  /yc exch def
  /xc exch def
    xc yc r
    y1 yc sub  x1 xc sub  atan
  end
} bind def

/arc_angle_to
{
  6 dict begin
  /y2 exch def
  /x2 exch def
  /a1 exch def
  /r exch def
  /yc exch def
  /xc exch def
    xc yc r a1
    y2 yc sub  x2 xc sub  atan
  end
} bind def

/path_as_upath % path_generator bool --> userpath
{
  1 dict begin
  /cache_upath exch def
  gsave
  newpath
  0 0 moveto
  load exec
  cache_upath upath
  grestore
  end
} def

% рисование рамки
/centered_frame % ширина высота толщина радиус_углов --> -
{
  9 dict begin
  /radius exch def % радиус скругления углов
  /thickness exch def % толщина рамки
  /size_v exch def % высота рамки
  /size_h exch def % ширина рамки

  /size_h_2_ext  size_h 2 div  def
  /size_v_2_ext  size_v 2 div  def
  /radius_ext  radius thickness add  def
  /size_h_2  size_h_2_ext thickness sub  def
  /size_v_2  size_v_2_ext thickness sub  def

    radius 0 eq
    {
      size_h_2_ext neg  size_v_2_ext neg  moveto
      size_h  0  rlineto
      0  size_v  rlineto
      size_h neg  0  rlineto
      closepath
      thickness dup  rmoveto
      0  size_v thickness 2 mul sub  rlineto
      size_h thickness 2 mul sub  0  rlineto
      0  size_v thickness 2 mul sub neg  rlineto
      closepath
    }
    {
      size_h_2_ext neg  0  moveto
        size_h_2_ext neg
        size_v_2_ext neg
        0
        size_v_2_ext neg
        radius_ext
      arct
        size_h_2_ext
        size_v_2_ext neg
        size_h_2_ext
        0
        radius_ext
      arct
        size_h_2_ext
        size_v_2_ext
        0
        size_v_2_ext
        radius_ext
      arct
        size_h_2_ext neg
        size_v_2_ext
        size_h_2_ext neg
        0
        radius_ext
      arct
      closepath

      size_h_2 neg  0  moveto
        size_h_2 neg
        size_v_2
        0
        size_v_2
        radius
      arct
        size_h_2
        size_v_2
        size_h_2
        0
        radius
      arct
        size_h_2
        size_v_2 neg
        0
        size_v_2 neg
        radius
      arct
        size_h_2 neg
        size_v_2 neg
        size_h_2 neg
        0
        radius
      arct
      closepath
    }
  ifelse

  end
} bind def

%%EOF
