%!PS-Adobe-2.0
%%Creator: Sergei S. Betke
%%EndComments

%%IncludeResource: procset boxes.ps 2.2 0
% # TODO: вернуть временное использование ProcSet boxes.ps
%/boxes.ps /ProcSet findresource begin
/boxes.ps /ProcSet findresource currentdict copy pop

(lib.ps) findlibfile { exch pop cvx exec } { (%stderr) (w) file  dup (Error: file ) writestring  dup  3 -1 roll  writestring  ( not found!\n) writestring  stop }  ifelse

(math.ps) require_once
(graphics.ps) require_once

% знак Росстандарта
/ST % H_size --> -
{
  10 dict begin
  /H exch def % параметр H (высота) знака
  /x1  15 tan  H 2 div  mul  neg  def
  /R1  H  H 2 div  15 cos  div  sub  def
  /x2  0.17 H mul  def
  /y2  R1 dup mul  x2 x1 sub  dup mul  sub  sqrt  def
  /R2  y2  0.25 H mul  add  def
  /x4  0.5 H mul  def
  /y4  3 sqrt  2 div  H mul  H 2 div  sub  def
  /x5  x4  def
  /y5  R2 dup mul  x5 x2 sub  dup mul  sub  sqrt  y2 sub  def

  % сохраняем на стеке текущую матрицу преобразования системы координат для последующего восстановления
  matrix currentmatrix
  % переносим начало координат в центр символа Ст
  currentpoint translate

  % С
  x4 y4 moveto
    0  H 2 div neg  H
    x4 y4 arc_angle_from
    105
  arc
  x1 0 R1 105 255 arc
    0  H 2 div  H
    255
    x4  y4 neg  arc_angle_to
  arc
  x5  y5 neg  lineto
    x2 y2 R2
    x5  y5 neg  arc_angle_from
    270
  arcn
  x2 0  0.25 H mul  270 90 arcn
    x2  y2 neg  R2
    90
    x5 y5  arc_angle_to
  arcn
  closepath

  % Т
    0.5  0.18 2 div  add  H mul
    0.25 H mul  2 div  neg
  moveto
  0  0.25 0.1 sub  H mul  rlineto
  0.35 0.18 sub  2 div  H mul  0  rlineto
  0  0.1 H mul  rlineto
  0.35 H mul neg  0  rlineto
  0  0.1 H mul neg  rlineto
  0.35 0.18 sub  2 div  H mul  0  rlineto
  0  0.25 0.1 sub  H mul  neg  rlineto
  closepath

  % восстановливаем систему координат
  setmatrix

  end
} bind def

/ust  1 /ST true path_as_upath  cvlit def

% # TODO: вернуть временное использование ProcSet boxes.ps
%end % /boxes.ps /ProcSet findresource begin

%%EOF
